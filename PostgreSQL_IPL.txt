# We first created the ipl database. 
CREATE DATABASE ipl;

# We moved into the database.
\c ipl

# This command will let us see the number of databases for current user.
\l

# This command will let us see the number of roles.
\du

# This query will let us make the column headers for 'matches' table.
CREATE TABLE matches (id integer, season integer, city varchar, date date, team1 varchar, team2 varchar, toss_winner varchar, toss_decision varchar, result varchar, dl_applied integer, winner varchar, win_by_runs integer, win_by_wickets integer, player_of_the_match varchar, venue varchar, umpire1 varchar, umpire2 varchar, umpire3 integer);

# This query will put the values from the csv file to the table to which the columns are headers.
copy matches from '/home/shaik/Documents/Mountblue/Serverside development/Python/Projects/Project_1/ipl_project/matches.csv' with (format 'csv', header true);

# This query will let us make the column headers for 'deliveries' table.
CREATE TABLE deliveries (matchid integer, inning integer, batting_team varchar, bowling_team varchar, over integer, ball integer, batsman varchar, non_striker varchar, bowler varchar, is_super_over integer, wide_runs integer, bye_runs integer, legbye_runs integer, noball_runs integer, penalty_runs integer, batsman_runs integer, extra_runs integer, total_runs integer,  player_dismissed varchar, dismissal_kind varchar, fielder varchar);

# This query will put the values from the csv file to the table to which the columns are headers.
copy deliveries from '/home/shaik/Documents/Mountblue/Serverside development/Python/Projects/Project_1/ipl_project/deliveries.csv' with (format 'csv', header true);

# Check the number of tables in the database.
\dt

# Chec t
\d matches

SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'deliveries';

SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'matches';


1. SELECT batting_team, SUM(total_runs) FROM deliveries GROUP BY batting_team ORDER BY sum desc;

2. SELECT batsman, SUM(total_runs) FROM deliveries WHERE batting_team = 'Royal Challengers Bangalore' GROUP BY batsman ORDER BY sum desc;

3. SELECT DISTINCT * FROM umpire_location;

4. 
